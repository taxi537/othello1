<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>سیستم بررسی شیفت‌های تاکسی</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap");

    body {
      margin:0;
      font-family:"Vazirmatn",sans-serif;
      background: linear-gradient(135deg, #ffcc00, #ff9900);
      color:#000;
      text-align:center;
      overflow-x:hidden;
    }

    /* پس‌زمینه توپ‌ها */
    #balls-bg {
      position: fixed;
      top:0; left:0; width:100%; height:100%;
      z-index:0;
      pointer-events: none;
    }
    .ball {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #000, #333);
      opacity:0.85;
      animation: float 12s linear infinite;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#ffcc00;
      font-weight:bold;
      font-size:1.2rem;
    }
    .ball:nth-child(1){width:80px;height:80px;top:10%;left:15%;animation-duration:8s;}
    .ball:nth-child(2){width:100px;height:100px;top:40%;left:70%;animation-duration:10s;}
    .ball:nth-child(3){width:90px;height:90px;top:70%;left:30%;animation-duration:14s;}
    .ball:nth-child(4){width:70px;height:70px;top:20%;left:80%;animation-duration:9s;}

    @keyframes float{
      0%{transform: translate(0,0) rotate(0deg);}
      50%{transform: translate(40px,-30px) rotate(180deg);}
      100%{transform: translate(0,0) rotate(360deg);}
    }

    header, .section {
      position: relative;
      z-index:1;
    }

    header {
      padding:15px;
      font-weight:bold;
      background: rgba(0,0,0,0.7);
      box-shadow: 0 4px 15px rgba(0,0,0,0.7);
      border-bottom: 2px solid rgba(255,204,0,0.7);
      position: sticky;
      top:0;
    }
    .title {
      font-size:2rem;
      margin-bottom:5px;
      color:#ffcc00;
      text-shadow:0 0 10px #000,0 0 20px #333;
    }
    .clock {
      font-size:2.5rem;
      font-weight:bold;
      color:#fff;
      text-shadow:0 0 12px #000,0 0 25px #555;
    }

    .section {
      background: rgba(255,255,255,0.2);
      margin:15px auto;
      padding:15px;
      border-radius:15px;
      width:90%;
      max-width:800px;
      backdrop-filter: blur(6px);
      box-shadow:0 6px 20px rgba(0,0,0,0.5);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .section:hover{
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
    }

    h2{
      color:#000;
      text-shadow:0 0 5px #ffcc00;
      margin-bottom:10px;
    }

    table {
      width:100%;
      border-collapse: collapse;
      margin-top:10px;
      font-size:0.95rem;
    }
    th,td {
      padding:8px;
      border-bottom:1px solid rgba(0,0,0,0.2);
      text-align:center;
    }
    table th {
      background: rgba(0,0,0,0.7);
      color:#ffcc00;
    }
    tr:hover{ background: rgba(255,255,255,0.2); }

    /* وقتی تار میشه */
    .blurred {
      filter: blur(4px);
      opacity: 0.6;
      transition: all 0.4s ease;
    }
  </style>
</head>
<body>
  <!-- توپ‌ها -->
  <div id="balls-bg">
    <div class="ball">TAXI</div>
    <div class="ball">TAXI</div>
    <div class="ball">TAXI</div>
    <div class="ball">TAXI</div>
  </div>

  <!-- محتوای اصلی -->
  <header>
    <div class="title">سیستم بررسی شیفت‌های تاکسی</div>
    <div class="clock" id="clock"></div>
  </header>

  <div class="section" id="current-shifts">
    <h2>شیفت فعلی</h2>
    <div id="shift-list"></div>
  </div>

  <div class="section" id="schedule-section">
    <h2>جدول کامل شیفت‌ها</h2>
    <table id="full-schedule">
      <thead>
        <tr>
          <th>نام</th>
          <th>رنک</th>
          <th>روز / حالت</th>
          <th>ساعت</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- اسکریپت -->
  <script>
   const shifts = [
    {name:"Danyall Abbasi",rank:"Taxi Director",times:[{days:"همه روزها",start:"20:00",end:"23:00"}]},
    {name:"Kourosh Zabeti",rank:"Taxi Deputy Director",times:[{days:"همه روزها",start:"14:00",end:"17:00"}]},
    {name:"Parham Azizi",rank:"Taxi Attendant",times:[{days:"همه روزها",start:"12:00",end:"12:01"}]},
    {name:"Abbas Abbasi",rank:"Taxi Attendant",times:[
        {days:"همه روزها",start:"12:00",end:"15:00"}
    ]},
    {name:"Parsa Rahimi",rank:"Taxi Attendant",times:[{days:"همه روزها",start:"12:00",end:"15:00"}]},
    {name:"Arya Khazeie",rank:"Taxi Attendant",times:[{days:"همه روزها",start:"20:30",end:"23:30"}]}
   ];

    function $(s){return document.querySelector(s);}
    function toPersianDigits(str){return String(str).replace(/\d/g,d=>"۰۱۲۳۴۵۶۷۸۹"[d]);}
    function timeToMins(t){const [h,m]=t.split(":").map(Number);return h*60+m;}
    function isEvenDay(date){
      const day = date.getDay();
      return [6,1,3,5].includes(day);
    }

    function updateClock(){
      const now=new Date();
      $("#clock").textContent=`${toPersianDigits(String(now.getHours()).padStart(2,"0"))}:${toPersianDigits(String(now.getMinutes()).padStart(2,"0"))}:${toPersianDigits(String(now.getSeconds()).padStart(2,"0"))}`;
    }

    function renderFullSchedule(){
      const tbody=$("#full-schedule tbody");
      tbody.innerHTML=shifts.map(p=>p.times.map(t=>`
        <tr>
          <td>${p.name}</td>
          <td>${p.rank}</td>
          <td>${t.days}</td>
          <td>${toPersianDigits(t.start)} تا ${toPersianDigits(t.end)}</td>
        </tr>`).join("")).join("");
    }

    function renderCurrentShifts(){
      const now=new Date();
      const curMins=now.getHours()*60+now.getMinutes();
      const even=isEvenDay(now);
      const active=[];
      shifts.forEach(p=>{
        p.times.forEach(t=>{
          let match=false;
          if(t.days==="همه روزها") match=true;
          if(t.days==="روز زوج"&&even) match=true;
          if(t.days==="روز فرد"&&!even) match=true;
          if(!match) return;
          const start=timeToMins(t.start),end=timeToMins(t.end);
          if(curMins>=start&&curMins<end){
            const remain=end-curMins;
            const rh=Math.floor(remain/60),rm=remain%60;
            active.push(`${p.name} (${p.rank}) - ${rh>0?toPersianDigits(rh)+" ساعت و ":""}${toPersianDigits(rm)} دقیقه مانده`);
          }
        });
      });

      const shiftBox = $("#shift-list");
      const fullSection = $("#schedule-section");

      if(active.length){
        shiftBox.innerHTML=active.map(x=>`<div>${x}</div>`).join("");
        fullSection.classList.add("blurred");
      } else {
        shiftBox.innerHTML="<div>در حال حاضر کسی در شیفت نیست</div>";
        fullSection.classList.remove("blurred");
      }
    }

    updateClock(); renderFullSchedule(); renderCurrentShifts();
    setInterval(updateClock,1000);
    setInterval(renderCurrentShifts,1000);
  </script>
</body>
</html>
